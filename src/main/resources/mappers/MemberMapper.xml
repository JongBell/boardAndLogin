<?xml version="1.0" encoding="UTF-8"?>

   <!DOCTYPE mapper
     PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ansim.mapper.MemberMapper">

<!-- 회원가입 -->
<insert id="memberInfoRegistry" parameterType="com.ansim.dto.MemberDTO">
	insert into MEM_INFO_TBL
	    (user_id, user_nm, password, age, gender, mbti, tel_no, regdate, last_pw_date, pw_chk, role, org_file_nm, stored_file_nm, file_size, ansim_cnt)
	values
	    (#{user_id},#{user_nm},#{password},#{age},#{gender},#{mbti},#{tel_no},now(), #{last_pw_date},1 ,'USER', #{org_file_nm},#{stored_file_nm},#{file_size},#{ansim_cnt})
   </insert>

<!-- 아이디 중복 확인 -->
<select id="idCheck" parameterType="String" resultType="int">
   select count(*) from MEM_INFO_TBL where user_id = #{user_id}
</select>

<!-- 회원정보 가져오기 -->
<select id="memberInfo" parameterType="String" resultType="com.ansim.dto.MemberDTO">
	select * from MEM_INFO_TBL where user_id = #{user_id}
</select>

<!-- 최종 로그인 시간 -->
<update id="lastlogindateUpdate" parameterType="com.ansim.dto.MemberDTO">
   update MEM_INFO_TBL set last_login_date=#{last_login_date} where user_id=#{user_id}
</update>

<!-- authkey 업데이트 -->
<update id="authkeyUpdate" parameterType="com.ansim.dto.MemberDTO">
	update MEM_INFO_TBL set authkey = #{authkey} where user_id=#{user_id}
</update>

<!-- authkey를 존재 여부 확인 -->
<select id="memberInfoByAuthkey" parameterType="com.ansim.dto.MemberDTO" resultType="com.ansim.dto.MemberDTO">
	select * from MEM_INFO_TBL where authkey = #{authkey}
</select>
	
</mapper>